<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Post-Quantum Cryptography in Android</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Post-Quantum Cryptography in Android</h1>
</header>
<section data-field="subtitle" class="p-summary">
The new quantum (computer) technology will have a massive effect on all of us when thinking in cryptography terms. Nearly every…
</section>
<section data-field="body" class="e-content">
<section name="f537" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="af1f" id="af1f" class="graf graf--h3 graf--leading graf--title">Post-Quantum Cryptography in Android</h3><p name="1581" id="1581" class="graf graf--p graf-after--h3">The new quantum (computer) technology will have a massive effect on all of us when thinking in cryptography terms. Nearly every communication and most financial transactions are secured by using cryptography. Learn how to use new developed algorithms on Android that are proposed as “Post-Quantum proof”.</p><p name="fc77" id="fc77" class="graf graf--p graf-after--p">All private-public key that are in use nowadays do have a mathematical trapdor — if you know all parameters they are “easy” to calculate but the other way round they are realy hard to resolve. As example I choose the RSA algorithm that is in use for electronic signatures, key encapsulating mechanisms or key exchange proceedings. It works by multiplication of very long primes, but the way back would be a prime number decomposition and takes even on supercomputers too much time to finish.</p><p name="1804" id="1804" class="graf graf--p graf-after--p">Using a quantum computer will crash that — you can get the (prime) factors of a very very large number within milliseconds because a quantum computer can solve calculation in a multiple way… boom.</p><p name="e445" id="e445" class="graf graf--p graf-after--p">Because of that the United States “<a href="https://www.nist.gov/" data-href="https://www.nist.gov/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">National Institute of Standards and Technology</a>” initiated “a process to solicit, evaluate, and standardize one or more quantum-resistant public-key cryptographic algorithms” in 2016 and in 4 rounds 4 “selected algorithms” were choosen to get the successors of RSA, Elliptic curves and other algorithms.</p><p name="4f6c" id="4f6c" class="graf graf--p graf-after--p">The app I’m describing here runs on modern Android smartphones and uses the well known cryptography library <strong class="markup--strong markup--p-strong">Bouncy Castle</strong> for the new algorithms. The complete code is available on my GitHub repository, see the link at the end of the article.</p><p name="f447" id="f447" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Please keep in mind that all algorithms and their parameters are not final at the moment and should be not be used in production environments but as a case study.</strong></p><p name="1a32" id="1a32" class="graf graf--p graf-after--p">What are the use cases for the new algorithms ? There are two cryptographic groups involved in the NIST competition: the first are the <strong class="markup--strong markup--p-strong">Public-key Encryption and Key-establishment Algorithms</strong> (KEM) and the second are <strong class="markup--strong markup--p-strong">Digital Signature Algorithms</strong> (SIG).</p><p name="b2ee" id="b2ee" class="graf graf--p graf-after--p">What is a <strong class="markup--strong markup--p-strong">Public-key Encryption and Key-establishment Algorithm</strong> ? This algorithm takes care for a secure way to exchange an encryption key between the sender and the recipient. A <strong class="markup--strong markup--p-strong">Digital Signature Algorithm</strong> is the electronic pendant to a handwritten signature and allows for the verification that a document (or file, photo…) is from the person or organization. Both algorithms are of the <strong class="markup--strong markup--p-strong">Public-Private-Key cryptography</strong> type (“asymmetric cryptography”).</p><p name="83fc" id="83fc" class="graf graf--p graf-after--p">If you should ask yourself “why is there no new algorithm for symmetric cryptography” there is a simple answer: At the moment the secure level of e.g. AES-256 (using a 32 byte long key) will (“only”) get halved in the PQC world.</p><p name="c457" id="c457" class="graf graf--p graf-after--p">Let’s have a look on the implementation. To get your app to work you need a actual Bouncy Castle provider library (I used version 1.72 and it is the extended version to run the NTRU examples) and you simply use this line in your build.gradle (module):</p><pre name="90b3" id="90b3" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">implementation group: &#39;org.bouncycastle&#39;, name: &#39;bcprov-ext-jdk18on&#39;, version: &#39;1.72&#39;</em></pre><p name="0689" id="0689" class="graf graf--p graf-after--pre">Additionally you need the permission to write to external storage and a query for sending the logfile in an email, both in AndroidManifest.xml:</p><pre name="095b" id="095b" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">&lt;?</em>xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;<em class="markup--em markup--pre-em">?&gt;<br></em>&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;<br>    xmlns:tools=&quot;http://schemas.android.com/tools&quot;<br>    package=&quot;de.androidcrypto.postquantumcryptographybc&quot;&gt;<br>    &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;<br><br>    &lt;application<br>        ...<br>        &lt;activity<br>            android:name=&quot;.MainActivity&quot;<br>            android:exported=&quot;true&quot;&gt;<br>            &lt;intent-filter&gt;<br>                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;<br><br>                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;<br>            &lt;/intent-filter&gt;<br>        &lt;/activity&gt;<br>    &lt;/application&gt;<br>    &lt;queries&gt;<br>        &lt;intent&gt;<br>            &lt;action android:name=&quot;android.intent.action.SENDTO&quot; /&gt;<br>            &lt;data android:scheme=&quot;*&quot; /&gt;<br>        &lt;/intent&gt;<br>    &lt;/queries&gt;<br><br>&lt;/manifest&gt;</pre><p name="2f77" id="2f77" class="graf graf--p graf-after--pre">The MainActivity is acting as a “console” view for each algorithm that comes in separate classes.</p><p name="f4e0" id="f4e0" class="graf graf--p graf-after--p">As Bouncy Castle was part of Android in earlier versions but was removed in it’s core functionality it is important to remove any (still) existing part of Bouncy Castle and then add the new version as well as the Post-Quantum Cryptography (PQC) provider:</p><pre name="5c49" id="5c49" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">// this way for adding bouncycastle to android<br></em>Security.<em class="markup--em markup--pre-em">removeProvider</em>(&quot;BC&quot;);<br><em class="markup--em markup--pre-em">// Confirm that positioning this provider at the end works for your needs!<br></em>Security.<em class="markup--em markup--pre-em">addProvider</em>(new BouncyCastleProvider());<br>if (Security.<em class="markup--em markup--pre-em">getProvider</em>(&quot;BCPQC&quot;) == null) {<br>    Security.<em class="markup--em markup--pre-em">addProvider</em>(new BouncyCastlePQCProvider());<br>}</pre><p name="8f78" id="8f78" class="graf graf--p graf-after--pre">When starting the app you can select an algorithm by using the spinner (“choose algorithm to run and WAIT”) but have a look to the warning below — <strong class="markup--strong markup--p-strong">the algorithms will run on the main thread</strong> and as some calculations run very slow there is the high chance that your complete user interface will get blocked during a algorithm run. <strong class="markup--strong markup--p-strong">Please run the algorithms only when you don’t need your device for some minutes</strong>…</p><figure name="0b17" id="0b17" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*OopBUe9TxSF4f4EvokqpnQ.png" data-width="500" data-height="449" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*OopBUe9TxSF4f4EvokqpnQ.png"></figure><p name="d217" id="d217" class="graf graf--p graf-after--figure">You can choose on all PQC finalists and round 4 submissions, accompanied by some more algorithms:</p><figure name="b8fc" id="b8fc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ue0Tv-QCAo9d_ueMtLYyrw.png" data-width="500" data-height="944" src="https://cdn-images-1.medium.com/max/800/1*Ue0Tv-QCAo9d_ueMtLYyrw.png"></figure><p name="bfde" id="bfde" class="graf graf--p graf-after--figure">A warning dialog will popup and inform you about thee UI blocking:</p><figure name="2501" id="2501" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ecL3eAgfkBZinSM6zA8rLA.png" data-width="500" data-height="284" src="https://cdn-images-1.medium.com/max/800/1*ecL3eAgfkBZinSM6zA8rLA.png"></figure><p name="3fb4" id="3fb4" class="graf graf--p graf-after--figure">Now you need to wait until all possible parameter set have run through (here the Chrystals-Kyber KEM output is shown in a scrollable view):</p><figure name="4a0b" id="4a0b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*p7LS0OumYEp2VC4elyyZcA.png" data-width="500" data-height="841" src="https://cdn-images-1.medium.com/max/800/1*p7LS0OumYEp2VC4elyyZcA.png"></figure><p name="db56" id="db56" class="graf graf--p graf-after--figure">These algorithms are running at the moment:</p><pre name="80f4" id="80f4" class="graf graf--pre graf-after--p">The selected algorithms:<br><em class="markup--em markup--pre-em">```plaintext<br>Selected Algorithms: Public-key Encryption and Key-establishment Algorithms:<br>CRYSTALS-KYBER (3 parameter sets)<br><br>Selected Algorithms: Digital Signature Algorithms:<br>CRYSTALS-DILITHIUM (3 parameter sets)<br>FALCON (2 parameter sets)<br>SPHINCS+ (24 parameter sets)<br>```<br><br></em>Round 4 alternative algorithms/submissions:<br><em class="markup--em markup--pre-em">```plaintext<br>Round 4 Submissions: Public-key Encryption and Key-establishment Algorithms<br>BIKE (3 parameter sets)<br>Classic McEliece (6 parameter sets)<br>HQC (3 parameter sets)<br>SIKE (not available here because this algorithm is broken)<br>```<br><br></em>Some candidates from earlier rounds:<br><em class="markup--em markup--pre-em">```plaintext<br>Public-key Encryption and Key-establishment Algorithms<br>NTRU (7 parameter sets)<br>FRODO (6 parameter sets)<br>SABER (9 parameter sets)<br>NTRULPrime (6 parameter sets)<br>SNTRUPrime (6 parameter sets)<br><br>Digital Signature Algorithms<br>Rainbow (n.a., at the moment this algorithm got updated in Bouncy Castle 1.72)<br>Picnic (12 parameter sets)<br>```</em></pre><p name="0a26" id="0a26" class="graf graf--p graf-after--pre">A sample output is hown below for the Chrystals-Kyber KEM:</p><pre name="308c" id="308c" class="graf graf--pre graf-after--p"><em class="markup--em markup--pre-em">PQC Chrystals-Kyber KEM<br><br>************************************<br>* # # SERIOUS SECURITY WARNING # # *<br>* This program is a CONCEPT STUDY  *<br>* for the algorithm                *<br>* Chrystals-Kyber [key exchange    *<br>* mechanism]                       *<br>* The program is using an          *<br>* parameter set that I cannot      *<br>* check for the correctness of the *<br>* output and other details         *<br>*                                  *<br>*    DO NOT USE THE PROGRAM IN     *<br>*    ANY PRODUCTION ENVIRONMENT    *<br>************************************<br><br>****************************************<br><br>Chrystals-Kyber KEM with parameterset kyber512<br><br>generated private key length: 1688<br>generated public key length:  834<br><br>Encryption side: generate the encryption key and the encapsulated key<br>encryption key length: 16 key: 618df6a4c429da50ab6c72d6d4847c52<br>encapsulated key length: 768 key: 45c1df5c9fcad76db3871656e4f3102e ...<br><br>Decryption side: receive the encapsulated key and generate the decryption key<br>decryption key length: 16 key: 618df6a4c429da50ab6c72d6d4847c52<br>decryption key is equal to encryption key: true<br><br>****************************************<br><br>Chrystals-Kyber KEM with parameterset kyber768<br><br>generated private key length: 2456<br>generated public key length:  1218<br><br>Encryption side: generate the encryption key and the encapsulated key<br>encryption key length: 24 key: 5c676b2f35ed452779438f96f0b2cab92546ab45307b101f<br>encapsulated key length: 1088 key: 19d336551bcfaea404dd67235c629f62 ...<br><br>Decryption side: receive the encapsulated key and generate the decryption key<br>decryption key length: 24 key: 5c676b2f35ed452779438f96f0b2cab92546ab45307b101f<br>decryption key is equal to encryption key: true<br><br>****************************************<br><br>Chrystals-Kyber KEM with parameterset kyber1024<br><br>generated private key length: 3224<br>generated public key length:  1602<br><br>Encryption side: generate the encryption key and the encapsulated key<br>encryption key length: 32 key: f1651c857bbbb01d0a1a32cdeb628f19d54a5dc787408d97354871b62e06fcd3<br>encapsulated key length: 1568 key: e7c638664c7b9146e1eff3c1b11a16d8 ...<br><br>Decryption side: receive the encapsulated key and generate the decryption key<br>decryption key length: 32 key: f1651c857bbbb01d0a1a32cdeb628f19d54a5dc787408d97354871b62e06fcd3<br>decryption key is equal to encryption key: true<br><br>****************************************<br><br>Test results<br>parameter spec name  priKL   pubKL encKL capKL  keyE<br>kyber512              1688     834    16   768  true<br>kyber768              2456    1218    24  1088  true<br>kyber1024             3224    1602    32  1568  true<br><br>Legend: priKL privateKey length, pubKL publicKey length, encKL encryption key length, capKL encapsulated key length<br>****************************************</em></pre><p name="f3d8" id="f3d8" class="graf graf--p graf-after--pre">There is a toolbar menu available for sending an email with the logfile or save it in the external storage.</p><p name="f5fb" id="f5fb" class="graf graf--p graf-after--p">A last question remains — <strong class="markup--strong markup--p-strong">why are the new algorithms not in production use at the moment ?</strong> The answer is simple — they are not production ready at the moment for a lot of reasons. The main issue is that the length of the private or public key is much longer than the known ones. The second point — the encapsulated encryption keys (used in a KEM) are much longer as the ones used with known algorithms. Third: a signature generated by the PQC SIG’s is much longer than known ones. At last but not least: it takes much longer to generate the keys and perform the calculations.</p><p name="0704" id="0704" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Source code</strong>: The complete app is available in my GitHub repository:<a href="https://github.com/AndroidCrypto/PostQuantumCryptographyBc172" data-href="https://github.com/AndroidCrypto/PostQuantumCryptographyBc172" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank"> PostQuantumCryptographyBc172</a>.</p><p name="1aa3" id="1aa3" class="graf graf--p graf-after--p">Have fun with the new crypto world.</p><p name="92a5" id="92a5" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Documentation:</strong></p><p name="1ba7" id="1ba7" class="graf graf--p graf-after--p">The official NIST homepage for PQC: <a href="https://csrc.nist.gov/Projects/post-quantum-cryptography" data-href="https://csrc.nist.gov/Projects/post-quantum-cryptography" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://csrc.nist.gov/Projects/post-quantum-cryptography</a></p><p name="0d7f" id="0d7f" class="graf graf--p graf-after--p">Selected algorithms overview: <a href="https://csrc.nist.gov/Projects/post-quantum-cryptography/selected-algorithms-2022" data-href="https://csrc.nist.gov/Projects/post-quantum-cryptography/selected-algorithms-2022" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://csrc.nist.gov/Projects/post-quantum-cryptography/selected-algorithms-2022</a></p><p name="7fb5" id="7fb5" class="graf graf--p graf-after--p">Round 4 submissions: <a href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-4-submissions" data-href="https://csrc.nist.gov/Projects/post-quantum-cryptography/round-4-submissions" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://csrc.nist.gov/Projects/post-quantum-cryptography/round-4-submissions</a></p><p name="1847" id="1847" class="graf graf--p graf-after--p">Bouncy Castle GitHub repository: <a href="https://github.com/bcgit/bc-java/blob/master/docs/releasenotes.html" data-href="https://github.com/bcgit/bc-java/blob/master/docs/releasenotes.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/bcgit/bc-java/</a></p><p name="a17f" id="a17f" class="graf graf--p graf-after--p graf--trailing">Bouncy Castle release notes: <a href="https://github.com/bcgit/bc-java/blob/master/docs/releasenotes.html" data-href="https://github.com/bcgit/bc-java/blob/master/docs/releasenotes.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/bcgit/bc-java/blob/master/docs/releasenotes.html</a></p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@androidcrypto" class="p-author h-card">AndroidCrypto</a> on <a href="https://medium.com/p/8c87b6024bf5"><time class="dt-published" datetime="2022-11-02T21:53:03.581Z">November 2, 2022</time></a>.</p><p><a href="https://medium.com/@androidcrypto/post-quantum-cryptography-in-android-8c87b6024bf5" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 27, 2022.</p></footer></article></body></html>