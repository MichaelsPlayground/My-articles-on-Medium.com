<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Secure your device with ASCON, the new encryption standard for small devices (Java)</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Secure your device with ASCON, the new encryption standard for small devices (Java)</h1>
</header>
<section data-field="subtitle" class="p-summary">
On Feb. 7th. 2023 NIST (https://csrc.nist.gov/News/2023/lightweight-cryptography-nist-selects-ascon) announced the selection of the…
</section>
<section data-field="body" class="e-content">
<section name="65ab" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="601f" id="601f" class="graf graf--h3 graf--leading graf--title">Secure your device with ASCON, the new encryption standard for small devices (Java)</h3><p name="62e5" id="62e5" class="graf graf--p graf-after--h3">On Feb. 7th. 2023 NIST (<a href="https://csrc.nist.gov/News/2023/lightweight-cryptography-nist-selects-ascon" data-href="https://csrc.nist.gov/News/2023/lightweight-cryptography-nist-selects-ascon" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://csrc.nist.gov/News/2023/lightweight-cryptography-nist-selects-ascon</a>) announced the selection of the encryption algorithm family <strong class="markup--strong markup--p-strong">ASCON</strong> as new standard for encryption on small devices:</p><blockquote name="1a78" id="1a78" class="graf graf--blockquote graf-after--p">The team has decided to standardize the <strong class="markup--strong markup--blockquote-strong">Ascon </strong>family for lightweight cryptography applications as it meets the needs of most use cases where lightweight cryptography is required. Congratulations to the Ascon team! NIST thanks all of the finalist teams and the community members who provided feedback that contributed to the selection.</blockquote><p name="64ba" id="64ba" class="graf graf--p graf-after--blockquote">My first impression was — “why do we need a new encryption algorithm, we do have AES-CBC, AES-GCM and the Libsodium encryption schemes ?”. But then I realized that these algorithms usually run fast on modern computers and smartphones because they have special instruction sets in their microcontrollers that optimize the algorithms running. The new algorithm is dedicated to those devices with a different chipset like Bluetooth beacons or sensors or NFC/RFID environments that run with limited resources (“small devices”).</p><p name="50e1" id="50e1" class="graf graf--p graf-after--p">The <strong class="markup--strong markup--p-strong">ASCON algorithm</strong> works very similar to the well known AES-GCM algorithm as it provides an <strong class="markup--strong markup--p-strong">authenticated encryption</strong> and can <strong class="markup--strong markup--p-strong">authenticate (unencrypted) additional data</strong> (“AEAD”) as well.</p><p name="5018" id="5018" class="graf graf--p graf-after--p">This is the <strong class="markup--strong markup--p-strong">profile of the algorithm</strong>:</p><ul class="postList"><li name="5359" id="5359" class="graf graf--li graf-after--p">encryption type: symmetric encryption</li><li name="ff8b" id="ff8b" class="graf graf--li graf-after--li">key length: 128 bit (16 byte)</li><li name="b960" id="b960" class="graf graf--li graf-after--li">block length: 128 bit (16 byte)</li><li name="bb35" id="bb35" class="graf graf--li graf-after--li">nonce length: 128 bit (16 byte)</li><li name="17ab" id="17ab" class="graf graf--li graf-after--li">authentication tag length: 128 bit (16 byte)</li></ul><p name="09a7" id="09a7" class="graf graf--p graf-after--li">You find more details on the algorithm on the inventor`s website (<a href="https://ascon.iaik.tugraz.at/index.html" data-href="https://ascon.iaik.tugraz.at/index.html" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://ascon.iaik.tugraz.at/index.html</a>); the latest specification update is available on the NIST page: <a href="https://csrc.nist.gov/csrc/media/Projects/lightweight-cryptography/documents/finalist-round/status-updates/ascon-update.pdf" data-href="https://csrc.nist.gov/csrc/media/Projects/lightweight-cryptography/documents/finalist-round/status-updates/ascon-update.pdf" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://csrc.nist.gov/csrc/media/Projects/lightweight-cryptography/documents/finalist-round/status-updates/ascon-update.pdf</a>. The algorithm was invented by Christoph Dobraunig, Maria Eichlseder, Florian Mendel and Martin Schläffer.</p><p name="02dd" id="02dd" class="graf graf--p graf-after--p">Now we are moving over to the practical side and run an encryption and decryption on an Android device (Android 13 / SDK 33) using the Java reference code (<a href="https://github.com/ascon/javaascon" data-href="https://github.com/ascon/javaascon" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/ascon/javaascon</a>). At the moment there are 3 algorithms choosen (Ascon-128, Ascon-128a and Ascon-80pq), but the Java reference code provides only code for the first two ones. The major security provider for Java (Bouncy Castle, <a href="https://github.com/bcgit/bc-java/" data-href="https://github.com/bcgit/bc-java/" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/bcgit/bc-java/</a>) is updating the sources in these days so within the next time an implementation with all of them should be available as well.</p><p name="51e3" id="51e3" class="graf graf--p graf-after--p">The sample app will inform you about the purpose of the app and lets you chose the algorithm (Ascon128v12 orAscon128av128):</p><figure name="3123" id="3123" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RhMzd1FfrMeuk1MMrxke8A.png" data-width="496" data-height="447" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*RhMzd1FfrMeuk1MMrxke8A.png"></figure><figure name="92a9" id="92a9" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*XGPdUDWnTf3UHsNcTfUdLw.png" data-width="495" data-height="313" alt="chose the algorithm Ascon128v12 or Ascon128av12" src="https://cdn-images-1.medium.com/max/800/1*XGPdUDWnTf3UHsNcTfUdLw.png"></figure><p name="9b97" id="9b97" class="graf graf--p graf-after--figure">To run the code in MainActivity.java just copy the two files “Ascon128v12.java” and “Ascon128av12.java” from the reference code to your package (and change the package name accordingly). There are four methods available for each algorithm and for the reason of clarity I did not make just one method for each purpose:</p><ul class="postList"><li name="b1ec" id="b1ec" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">ascon128v12Encryption</strong>: The method takes the 16 bytes long key and nonce, the plaintext and (optional) additional data; each in form of a byte array. The additional data will not get encrypted but are part of the authentication checksum. The output is the <strong class="markup--strong markup--li-strong">ciphertext</strong> that is of length (plaintext + authentication tag [16 bytes length]) or 0 byte if any error occurs. The (complete) ciphertext is a concatenation of the encrypted data and the <strong class="markup--strong markup--li-strong">authentication tag</strong> (“ciphertext | authentication tag”)</li><li name="a99a" id="a99a" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">ascon128v12Decryption</strong>: The method takes the 16 bytes long <strong class="markup--strong markup--li-strong">key</strong> and <strong class="markup--strong markup--li-strong">nonce</strong>, the (complete) <strong class="markup--strong markup--li-strong">ciphertext</strong> and (optional) <strong class="markup--strong markup--li-strong">additional data</strong>; each in form of a byte array. The additional data will not get decrypted but are part of the authentication checksum so you need to provide the exact same data as used on encryption. The output is the <strong class="markup--strong markup--li-strong">plaintext</strong> or and empty string if any error occurs.</li><li name="2f19" id="2f19" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">ascon128v12SplitCiphertext:</strong> This is just a service method that splits the (concatenated) complete ciphertext in the <strong class="markup--strong markup--li-strong">ciphertext</strong> and the <strong class="markup--strong markup--li-strong">authentication tag</strong>. As e.g. some Bluetooth Low Energy devices limit the transmission of data to 20 bytes per transmission it is helpful to have the ciphertext and authentication tag in different variables.</li><li name="3240" id="3240" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">ascon128v12ConcatenateCiphertext:</strong> This is the companion method to the “split method” — it takes the ciphertext and authentication tag and combines them to a “complete ciphertext”.</li></ul><p name="4db1" id="4db1" class="graf graf--p graf-after--li">These are the results when running a complete encryption and decryption on an emulator:</p><figure name="4a23" id="4a23" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*cNNwDTyMto469V0RrM9ziw.png" data-width="300" data-height="558" alt="results of an encryption and decryption with Ascon128v12" src="https://cdn-images-1.medium.com/max/800/1*cNNwDTyMto469V0RrM9ziw.png"></figure><p name="fc08" id="fc08" class="graf graf--p graf-after--figure">The code needed for the <strong class="markup--strong markup--p-strong">encryption</strong> is very simple — provide a 16 bytes long key and nonce, the plaintext to encrypt and (optional) some additional data and receive the encrypted and authenticated ciphertext (all data are byte arrays) [this code is for ASCON-128V12]:</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="java" name="e0b9" id="e0b9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] ascon128v12Encryption(<span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] key, <span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] nonce, <span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] plaintext, <span class="hljs-type">byte</span>[] additionalData) {<br />        <span class="hljs-comment">// sanity checks</span><br />        <span class="hljs-keyword">if</span> (key.length != <span class="hljs-number">16</span>) {<br />            Log.e(TAG, <span class="hljs-string">&quot;the key length has to be 16, found &quot;</span> + key.length);<br />            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">0</span>];<br />        }<br />        <span class="hljs-keyword">if</span> (nonce.length != <span class="hljs-number">16</span>) {<br />            Log.e(TAG, <span class="hljs-string">&quot;the nonce length has to be 16, found &quot;</span> + nonce.length);<br />            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">0</span>];<br />        }<br />        <span class="hljs-type">int</span> additionalDataLength;<br />        <span class="hljs-keyword">if</span> (additionalData == <span class="hljs-literal">null</span>) {<br />            additionalDataLength = <span class="hljs-number">0</span>;<br />        } <span class="hljs-keyword">else</span> {<br />            additionalDataLength = additionalData.length;<br />        }<br />        <span class="hljs-type">byte</span>[] s = {};<br />        <span class="hljs-type">byte</span>[] ciphertext = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[plaintext.length + Ascon128v12.CRYPTO_ABYTES];<br />        <span class="hljs-type">int</span> <span class="hljs-variable">clen</span> <span class="hljs-operator">=</span> Ascon128v12.crypto_aead_encrypt(ciphertext, ciphertext.length, plaintext, plaintext.length, additionalData, additionalDataLength, s, nonce, key);<br />        <span class="hljs-keyword">return</span> ciphertext;<br />    }</span></pre><p name="10a8" id="10a8" class="graf graf--p graf-after--pre">Running the <strong class="markup--strong markup--p-strong">decryption</strong> is as simple as the encryption — provide the same encryption key and nonce, the ciphertext and (optional) the additional data and receive the decrypted = plaintext:</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="java" name="38a9" id="38a9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">    <span class="hljs-keyword">private</span> <span class="hljs-type">byte</span>[] ascon128v12Decryption(<span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] key, <span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] nonce, <span class="hljs-meta">@NonNull</span> <span class="hljs-type">byte</span>[] ciphertext, <span class="hljs-type">byte</span>[] additionalData) {<br />        <span class="hljs-comment">// sanity checks</span><br />        <span class="hljs-keyword">if</span> (key.length != <span class="hljs-number">16</span>) {<br />            Log.e(TAG, <span class="hljs-string">&quot;the key length has to be 16, found &quot;</span> + key.length);<br />            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">0</span>];<br />        }<br />        <span class="hljs-keyword">if</span> (nonce.length != <span class="hljs-number">16</span>) {<br />            Log.e(TAG, <span class="hljs-string">&quot;the nonce length has to be 16, found &quot;</span> + nonce.length);<br />            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">0</span>];<br />        }<br />        <span class="hljs-type">int</span> additionalDataLength;<br />        <span class="hljs-keyword">if</span> (additionalData == <span class="hljs-literal">null</span>) {<br />            additionalDataLength = <span class="hljs-number">0</span>;<br />        } <span class="hljs-keyword">else</span> {<br />            additionalDataLength = additionalData.length;<br />        }<br />        <span class="hljs-type">byte</span>[] s = {};<br />        <span class="hljs-type">byte</span>[] plaintext = <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[ciphertext.length + Ascon128v12.CRYPTO_ABYTES];<br />        <span class="hljs-type">int</span> <span class="hljs-variable">plen</span> <span class="hljs-operator">=</span> Ascon128v12.crypto_aead_decrypt(plaintext, plaintext.length, s, ciphertext, ciphertext.length, additionalData, additionalDataLength, nonce, key);<br />        <span class="hljs-keyword">if</span> (plen != -<span class="hljs-number">1</span>) {<br />            <span class="hljs-keyword">return</span> Arrays.copyOfRange(plaintext, <span class="hljs-number">0</span>, plen);<br />        } <span class="hljs-keyword">else</span> {<br />            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[<span class="hljs-number">0</span>];<br />        }<br />    }</span></pre><p name="6144" id="6144" class="graf graf--p graf-after--pre">Please do not forget: if you use additional data on encryption it is mandatory to use the exact same data for decryption !</p><p name="afd3" id="afd3" class="graf graf--p graf-after--p">The complete code for the app is available on my GitHub repository: <a href="https://github.com/AndroidCrypto/AsconEncryption" data-href="https://github.com/AndroidCrypto/AsconEncryption" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">https://github.com/AndroidCrypto/AsconEncryption</a>.</p><p name="5d99" id="5d99" class="graf graf--p graf-after--p graf--trailing">Have fun with the new algorithm!</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@androidcrypto" class="p-author h-card">AndroidCrypto</a> on <a href="https://medium.com/p/ccb5447489c6"><time class="dt-published" datetime="2023-02-24T15:23:08.099Z">February 24, 2023</time></a>.</p><p><a href="https://medium.com/@androidcrypto/secure-your-device-with-ascon-the-new-encryption-standard-for-small-devices-java-ccb5447489c6" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on April 12, 2023.</p></footer></article></body></html>